SET SERVEROUTPUT ON;

-- Implicit Cursor
DECLARE
    v_rows NUMBER;
BEGIN
    INSERT INTO Student_Result (stud_id, name, dept, total_mark)
    VALUES (1, 'Sarthak', 'Computer', 1250);

    v_rows := SQL%ROWCOUNT;
    DBMS_OUTPUT.PUT_LINE(v_rows || ' row(s) inserted successfully.');
END;
/

-- Explicit Cursor
DECLARE
    CURSOR stud_cur IS
        SELECT name, total_mark FROM Student_Result;

    v_name Student_Result.name%TYPE;
    v_marks Student_Result.total_mark%TYPE;
BEGIN
    OPEN stud_cur;
    LOOP
        FETCH stud_cur INTO v_name, v_marks;
        EXIT WHEN stud_cur%NOTFOUND;
        DBMS_OUTPUT.PUT_LINE('Name: ' || v_name || ' | Marks: ' || v_marks);
    END LOOP;
    CLOSE stud_cur;
END;
/

-- Cursor FOR Loop
BEGIN
    FOR rec IN (SELECT name, total_mark FROM Student_Result) LOOP
        DBMS_OUTPUT.PUT_LINE('Name: ' || rec.name || ' | Marks: ' || rec.total_mark);
    END LOOP;
END;
/

-- Parameterized Cursor
DECLARE
    CURSOR dept_cur(p_dept VARCHAR2) IS
        SELECT name, total_mark
        FROM Student_Result
        WHERE dept = p_dept;
BEGIN
    DBMS_OUTPUT.PUT_LINE('Students from Computer Department:');
    FOR rec IN dept_cur('Computer') LOOP
        DBMS_OUTPUT.PUT_LINE('Name: ' || rec.name || ' | Marks: ' || rec.total_mark);
    END LOOP;

    DBMS_OUTPUT.PUT_LINE(CHR(10) || 'Students from Mechanical Department:');
    FOR rec IN dept_cur('Mechanical') LOOP
        DBMS_OUTPUT.PUT_LINE('Name: ' || rec.name || ' | Marks: ' || rec.total_mark);
    END LOOP;
END;
/

-- Cursor FOR UPDATE
DECLARE
    CURSOR update_cur IS
        SELECT stud_id, total_mark
        FROM Student_Result
        FOR UPDATE;
BEGIN
    FOR rec IN update_cur LOOP
        UPDATE Student_Result
        SET total_mark = rec.total_mark + 10
        WHERE CURRENT OF update_cur;
    END LOOP;

    DBMS_OUTPUT.PUT_LINE('Marks updated successfully for all students.');
END;
/


CREATE TABLE Student_Result (
    stud_id NUMBER PRIMARY KEY,
    name VARCHAR2(50),
    dept VARCHAR2(30),
    total_mark NUMBER
);

INSERT INTO Student_Result VALUES (2, 'Riya', 'Computer', 980);
INSERT INTO Student_Result VALUES (3, 'Amit', 'Mechanical', 850);
INSERT INTO Student_Result VALUES (4, 'Neha', 'Electrical', 890);
COMMIT;
